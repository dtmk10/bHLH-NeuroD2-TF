library("ChIPseeker")
library("ChIPseeker")
library("ReactomePA")
# annotation of Mus musculus
library(TxDb.Mmusculus.UCSC.mm10.knownGene)
library(org.Mm.eg.db)
library("ChIPseeker")
library("ChIPseeker")
library("ReactomePA")
# annotation of Mus musculus
library(TxDb.Mmusculus.UCSC.mm10.knownGene)
txdb <- TxDb.Mmusculus.UCSC.mm10.knownGene
# annotation of Mus musculus in ENTREZ format
# Used in the functional analysis
library(org.Mm.eg.db)
mmdb <- org.Mm.eg.db
setwd("~/Documents/PGB-Workspace/bHLH-project/ChIP_seq/PeakCalling")
# The input is the peaks.narrowPeaks from macs2
narrowPeaks <- readPeakFile("IP_peaks.narrowPeak")
# The resized peaks with the middle point adjusted
peaksResized <- readPeakFile("IP_peaks.resized.bed")
promoter <- getPromoters(TxDb=txdb, upstream=3000, downstream=3000)
tagMatrix <- getTagMatrix(peaksResized, windows=promoter)
peak_Profile_Heatmap(peak = peaksResized,
upstream = 1000,
downstream = 1000,
by = "gene",
type = "start_site",
TxDb = txdb,
nbin = 800)
peakAnno <- annotatePeak(peaksResized, tssRegion=c(-3000, 3000),
TxDb=txdb)
plotAnnoPie(peakAnno)
vennpie(peakAnno)
plotDistToTSS(peakAnno, title = "Dist to TSS")
plotAnnoPie(peakAnno)
vennpie(peakAnno)
plotDistToTSS(peakAnno, title = "Dist to TSS")
gene <- seq2gene(peaksResized, tssRegion = c(-1000, 1000), flankDistance = 3000, TxDb=txdb)
pathway2 <- enrichPathway(gene, organism = "mouse")
pathway2@gene
sum(pathway2@result$p.adjust < 0.05)
dotplot(pathway2)
barplot(pathway2)
dotplot(pathway2)
barplot(pathway2)
